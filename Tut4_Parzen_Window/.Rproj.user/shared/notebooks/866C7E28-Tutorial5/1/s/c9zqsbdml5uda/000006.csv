"0","#DEFINING THE DENSITY ESTIMATION FUNCTION"
"0","#h is the windows width, k the utizlied kernel {""gauss"", ""epanechnikov""}"
"0","density_fun <- function (x, from, to, m, h, k){"
"0","  x <- matrix(x)"
"0","  n <- length(x) #number of observations  "
"0","  x_center <- seq(from, to, length.out=m) #vector of equidistant kernel centers"
"0","  "
"0","  #Initializing storage matrices"
"0","  g <- matrix(-777, n, m)"
"0","  "
"0","  if(k==""gauss""){"
"0","    g_fun <- function(x, x_center, h){"
"0","      (1/(h*sqrt(2*pi)))*exp(-0.5*((x_center-x)/h)^2) #window function?"
"0","    }"
"0","    g <- lapply(x_center, function(i){g_fun(x, i, h)})"
"0","    k_in <- as.matrix(unlist(lapply(g,sum)))"
"0","    p <- (1/n)*k_in"
"0","  }"
"0","  "
"0"," # if(k==""epanechnikov""){"
"0","    "
"0","    "
"0","    "
"0"," # }"
"0","return(list(p=p, x_centers=x_center, k_in=k_in)) #function output"
"0","}"
